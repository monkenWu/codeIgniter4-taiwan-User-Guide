

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="zh-TW" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="zh-TW" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Publisher &mdash; CodeIgniter4 4.1.5 說明文件</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script type="text/javascript" src="../_static/js/citheme.js"></script>
        <script type="text/javascript" src="../_static/js/carbon.js"></script>
        <script type="text/javascript" src="../_static/translations.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/citheme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜尋" href="../search.html" />
    <link rel="next" title="安全性類別" href="security.html" />
    <link rel="prev" title="Pagination" href="pagination.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #DD4814" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/ci-logo-text.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">歡迎加入 CodeIgniter4</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/index.html">歡迎加入 CodeIgniter4</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/requirements.html">系統需求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/credits.html">貢獻</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/psr.html">PSR 規範</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">安裝指引</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_composer.html">Composer 安裝</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_manual.html">手動安裝</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/running.html">運作你的應用程式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/upgrading.html">從舊版升級</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">故障排除</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/repositories.html">CodeIgniter 儲存庫</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">建構第一個應用程式</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/static_pages.html">靜態頁面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/news_section.html">新聞頁面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/create_news_items.html">建立新聞</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/conclusion.html">結論</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">CodeIgniter4 概觀</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/structure.html">應用程式結構</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/mvc.html">模型、視圖與控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/autoloader.html">自動載入檔案</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/services.html">服務（services）</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/factories.html">工廠模式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/http.html">處裡 HTTP 請求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/security.html">安全指南</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">一般主題</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/configuration.html">組態設定檔案</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/urls.html">CodeIgniter URLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/helpers.html">輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/common_functions.html">全域函數與常數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/logging.html">記錄日誌資訊</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/errors.html">錯誤處理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/caching.html">網頁快取</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/ajax.html">AJAX 請求</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/modules.html">程式碼模組</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/managing_apps.html">管理你的應用程式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/environments.html">處理多種環境</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../incoming/index.html">控制器與路由</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../incoming/controllers.html">控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/routing.html">URI Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/filters.html">Controller Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/message.html">HTTP Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/request.html">Request 類別</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/incomingrequest.html">IncomingRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/content_negotiation.html">內容協商</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/methodspoofing.html">HTTP 類型偽裝</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/restful.html">處理 RESTful 請求資源</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../outgoing/index.html">建構響應</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/views.html">視圖</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_cells.html">視圖單元</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_renderer.html">視圖渲染</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_layouts.html">視圖布局</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_parser.html">視圖解釋器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/table.html">HTML 表格類別</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/response.html">HTTP 響應</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/api_responses.html">API 響應特性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/localization.html">本土化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/alternative_php.html">用於視圖檔案的 PHP 語法</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">資料庫操作</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/examples.html">快速入門: 範例程式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/configuration.html">資料庫組態設定</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/connecting.html">連接你的資料庫</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/queries.html">執行查詢</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/results.html">產生查詢結果</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/helpers.html">查詢輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/query_builder.html">查詢生成器類別</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/transactions.html">交易</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/metadata.html">詮釋資料</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/call_function.html">自訂函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/events.html">資料庫事件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/utilities.html">資料庫工具</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">資料模型化</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/model.html">使用 CodeIgniter 的模型</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/entities.html">使用實體類別</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dbmgmt/index.html">資料庫管理</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/forge.html">資料庫操控與資料庫建構</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/migration.html">資料庫遷移</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/seeds.html">資料庫填充</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">程式庫參考</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="caching.html">Caching Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookies.html">Cookies</a></li>
<li class="toctree-l2"><a class="reference internal" href="curlrequest.html">CURLRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">Email Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="encryption.html">加密服務</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">Working with Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html#file-collections">File Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="honeypot.html">誘捕系統類別</a></li>
<li class="toctree-l2"><a class="reference internal" href="images.html">Image Manipulation Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagination.html">Pagination</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">安全性類別</a></li>
<li class="toctree-l2"><a class="reference internal" href="sessions.html">Session Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="throttler.html">Throttler</a></li>
<li class="toctree-l2"><a class="reference internal" href="time.html">Times and Dates</a></li>
<li class="toctree-l2"><a class="reference internal" href="typography.html">Typography</a></li>
<li class="toctree-l2"><a class="reference internal" href="uploaded_files.html">Working with Uploaded Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html">Working with URIs</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_agent.html">User Agent Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html">Validation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">輔助函數</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../helpers/array_helper.html">陣列輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/cookie_helper.html">Cookie 輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/date_helper.html">日期輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/filesystem_helper.html">檔案系統輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/form_helper.html">表單輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/html_helper.html">HTML Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/inflector_helper.html">Inflector 輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/number_helper.html">Number 輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/security_helper.html">安全性輔助函數</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/test_helper.html">Test Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/text_helper.html">Text Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/url_helper.html">URL Helper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../helpers/xml_helper.html">XML 輔助函數</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">測試</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/overview.html">入門</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/database.html">資料庫測試</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/fabricator.html">Generating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/controllers.html">控制器測試</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/feature.html">HTTP 特性測試</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/response.html">Testing Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/benchmark.html">基準測試</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/debugging.html">偵錯與除錯應用程式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/mocking.html">Mocking</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">使用命令列介面</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli.html">透過命命列運作</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_commands.html">自訂命令列介面指令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_generators.html">CLI Generators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_library.html">命令列程式庫</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_request.html">CLI 請求類別</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">擴充 CodeIgniter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/core_classes.html">建立核心系統類別</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/common.html">替換常用功能</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/events.html">事件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/basecontroller.html">擴充控制器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/authentication.html">認證方式</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/contributing.html">為 CodeIgniter 貢獻</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translation/index.html">CodeIgniter4 文件翻譯</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../translation/glossary.html">詞彙對照表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../translation/members.html">翻譯貢獻者</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CodeIgniter4</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">程式庫參考</a> &raquo;</li>
        
      <li>Publisher</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="publisher">
<h1>Publisher<a class="headerlink" href="#publisher" title="本標題的永久連結">¶</a></h1>
<p>The Publisher library provides a means to copy files within a project using robust detection and error checking.</p>
<div class="contents local topic" id="id1">
<ul class="simple">
<li><a class="reference internal" href="#loading-the-library" id="id2">Loading the Library</a></li>
<li><a class="reference internal" href="#concept-and-usage" id="id3">Concept and Usage</a><ul>
<li><a class="reference internal" href="#on-demand" id="id4">On Demand</a></li>
<li><a class="reference internal" href="#automation-and-discovery" id="id5">Automation and Discovery</a></li>
<li><a class="reference internal" href="#security" id="id6">Security</a></li>
</ul>
</li>
<li><a class="reference internal" href="#examples" id="id7">Examples</a><ul>
<li><a class="reference internal" href="#file-sync-example" id="id8">File Sync Example</a></li>
<li><a class="reference internal" href="#asset-dependencies-example" id="id9">Asset Dependencies Example</a></li>
<li><a class="reference internal" href="#module-deployment-example" id="id10">Module Deployment Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#library-reference" id="id11">Library Reference</a><ul>
<li><a class="reference internal" href="#support-methods" id="id12">Support Methods</a></li>
<li><a class="reference internal" href="#outputting-files" id="id13">Outputting Files</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="loading-the-library">
<h2><a class="toc-backref" href="#id2">Loading the Library</a><a class="headerlink" href="#loading-the-library" title="本標題的永久連結">¶</a></h2>
<p>Because Publisher instances are specific to their source and destination this library is not available
through <code class="docutils literal notranslate"><span class="pre">Services</span></code> but should be instantiated or extended directly. E.g.</p>
<blockquote>
<div>$publisher = new CodeIgniterPublisherPublisher();</div></blockquote>
</div>
<div class="section" id="concept-and-usage">
<h2><a class="toc-backref" href="#id3">Concept and Usage</a><a class="headerlink" href="#concept-and-usage" title="本標題的永久連結">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Publisher</span></code> solves a handful of common problems when working within a backend framework:</p>
<ul class="simple">
<li>How do I maintain project assets with version dependencies?</li>
<li>How do I manage uploads and other 「dynamic」 files that need to be web accessible?</li>
<li>How can I update my project when the framework or modules change?</li>
<li>How can components inject new content into existing projects?</li>
</ul>
<p>At its most basic, publishing amounts to copying a file or files into a project. <code class="docutils literal notranslate"><span class="pre">Publisher</span></code> extends <code class="docutils literal notranslate"><span class="pre">FileCollection</span></code>
to enact fluent-style command chaining to read, filter, and process input files, then copies or merges them into the target destination.
You may use <code class="docutils literal notranslate"><span class="pre">Publisher</span></code> on demand in your Controllers or other components, or you may stage publications by extending
the class and leveraging its discovery with <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">publish</span></code>.</p>
<div class="section" id="on-demand">
<h3><a class="toc-backref" href="#id4">On Demand</a><a class="headerlink" href="#on-demand" title="本標題的永久連結">¶</a></h3>
<p>Access <code class="docutils literal notranslate"><span class="pre">Publisher</span></code> directly by instantiating a new instance of the class:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$publisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">\CodeIgniter\Publisher\Publisher</span><span class="p">();</span>
</pre></div>
</div>
<p>By default the source and destination will be set to <code class="docutils literal notranslate"><span class="pre">ROOTPATH</span></code> and <code class="docutils literal notranslate"><span class="pre">FCPATH</span></code> respectively, giving <code class="docutils literal notranslate"><span class="pre">Publisher</span></code>
easy access to take any file from your project and make it web-accessible. Alternatively you may pass a new source
or source and destination into the constructor:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\Publisher\Publisher</span><span class="p">;</span>

<span class="nv">$vendorPublisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Publisher</span><span class="p">(</span><span class="nx">ROOTPATH</span> <span class="o">.</span> <span class="s1">&#39;vendor&#39;</span><span class="p">);</span>
<span class="nv">$filterPublisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Publisher</span><span class="p">(</span><span class="s1">&#39;/path/to/module/Filters&#39;</span><span class="p">,</span> <span class="nx">APPPATH</span> <span class="o">.</span> <span class="s1">&#39;Filters&#39;</span><span class="p">);</span>

<span class="c1">// Once the source and destination are set you may start adding relative input files</span>
<span class="nv">$frameworkPublisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Publisher</span><span class="p">(</span><span class="nx">ROOTPATH</span> <span class="o">.</span> <span class="s1">&#39;vendor/codeigniter4/codeigniter4&#39;</span><span class="p">);</span>

<span class="c1">// All &quot;path&quot; commands are relative to $source</span>
<span class="nv">$frameworkPublisher</span><span class="o">-&gt;</span><span class="na">addPath</span><span class="p">(</span><span class="s1">&#39;app/Config/Cookie.php&#39;</span><span class="p">);</span>

<span class="c1">// You may also add from outside the source, but the files will not be merged into subdirectories</span>
<span class="nv">$frameworkPublisher</span><span class="o">-&gt;</span><span class="na">addFiles</span><span class="p">([</span>
    <span class="s1">&#39;/opt/mail/susan&#39;</span><span class="p">,</span>
    <span class="s1">&#39;/opt/mail/ubuntu&#39;</span><span class="p">,</span>
<span class="p">]);</span>
<span class="nv">$frameworkPublisher</span><span class="o">-&gt;</span><span class="na">addDirectory</span><span class="p">(</span><span class="nx">SUPPORTPATH</span> <span class="o">.</span> <span class="s1">&#39;Images&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Once all the files are staged use one of the output commands (<strong>copy()</strong> or <strong>merge()</strong>) to process the staged files
to their destination(s):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="c1">// Place all files into $destination</span>
<span class="nv">$frameworkPublisher</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">();</span>

<span class="c1">// Place all files into $destination, overwriting existing files</span>
<span class="nv">$frameworkPublisher</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>

<span class="c1">// Place files into their relative $destination directories, overwriting and saving the boolean result</span>
<span class="nv">$result</span> <span class="o">=</span> <span class="nv">$frameworkPublisher</span><span class="o">-&gt;</span><span class="na">merge</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
<p>See the <a class="reference internal" href="#reference"><span class="std std-ref">Library Reference</span></a> for a full description of available methods.</p>
</div>
<div class="section" id="automation-and-discovery">
<h3><a class="toc-backref" href="#id5">Automation and Discovery</a><a class="headerlink" href="#automation-and-discovery" title="本標題的永久連結">¶</a></h3>
<p>You may have regular publication tasks embedded as part of your application deployment or upkeep. <code class="docutils literal notranslate"><span class="pre">Publisher</span></code> leverages
the powerful <code class="docutils literal notranslate"><span class="pre">Autoloader</span></code> to locate any child classes primed for publication:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">CodeIgniter\CLI\CLI</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Publisher\Publisher</span><span class="p">;</span>

<span class="k">foreach</span> <span class="p">(</span><span class="nx">Publisher</span><span class="o">::</span><span class="na">discover</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$publisher</span><span class="p">)</span>
<span class="p">{</span>
    <span class="nv">$result</span> <span class="o">=</span> <span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">publish</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$result</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nx">CLI</span><span class="o">::</span><span class="na">error</span><span class="p">(</span><span class="nb">get_class</span><span class="p">(</span><span class="nv">$publisher</span><span class="p">)</span> <span class="o">.</span> <span class="s1">&#39; failed to publish!&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>By default <code class="docutils literal notranslate"><span class="pre">discover()</span></code> will search for the 「Publishers」 directory across all namespaces, but you may specify a
different directory and it will return any child classes found:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$memePublishers</span> <span class="o">=</span> <span class="nx">Publisher</span><span class="o">::</span><span class="na">discover</span><span class="p">(</span><span class="s1">&#39;CatGIFs&#39;</span><span class="p">);</span>
</pre></div>
</div>
<p>Most of the time you will not need to handle your own discovery, just use the provided 「publish」 command:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="nx">php</span> <span class="nx">spark</span> <span class="nx">publish</span>
</pre></div>
</div>
<p>By default on your class extension <code class="docutils literal notranslate"><span class="pre">publish()</span></code> will add all files from your <code class="docutils literal notranslate"><span class="pre">$source</span></code> and merge them
out to your destination, overwriting on collision.</p>
</div>
<div class="section" id="security">
<h3><a class="toc-backref" href="#id6">Security</a><a class="headerlink" href="#security" title="本標題的永久連結">¶</a></h3>
<p>In order to prevent modules from injecting malicious code into your projects, <code class="docutils literal notranslate"><span class="pre">Publisher</span></code> contains a config file
that defines which directories and file patterns are allowed as destinations. By default, files may only be published
to your project (to prevent access to the rest of the filesystem), and the <strong>public/</strong> folder (<code class="docutils literal notranslate"><span class="pre">FCPATH</span></code>) will only
receive files with the following extensions:
* Web assets: css, scss, js, map
* Non-executable web files: htm, html, xml, json, webmanifest
* Fonts: tff, eot, woff
* Images: gif, jpg, jpeg, tiff, png, webp, bmp, ico, svg</p>
<p>If you need to add or adjust the security for your project then alter the <code class="docutils literal notranslate"><span class="pre">$restrictions</span></code> property of <code class="docutils literal notranslate"><span class="pre">Config\Publisher</span></code>.</p>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id7">Examples</a><a class="headerlink" href="#examples" title="本標題的永久連結">¶</a></h2>
<p>Here are a handful of example use cases and their implementations to help you get started publishing.</p>
<div class="section" id="file-sync-example">
<h3><a class="toc-backref" href="#id8">File Sync Example</a><a class="headerlink" href="#file-sync-example" title="本標題的永久連結">¶</a></h3>
<p>You want to display a 「photo of the day」 image on your homepage. You have a feed for daily photos but you
need to get the actual file into a browsable location in your project at <strong>public/images/daily_photo.jpg</strong>.
You can set up <a class="reference internal" href="../cli/cli_commands.html"><span class="doc">Custom Command</span></a> to run daily that will handle this for you:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Commands</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\CLI\BaseCommand</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Publisher\Publisher</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Throwable</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">DailyPhoto</span> <span class="k">extends</span> <span class="nx">BaseCommand</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$group</span>       <span class="o">=</span> <span class="s1">&#39;Publication&#39;</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$name</span>        <span class="o">=</span> <span class="s1">&#39;publish:daily&#39;</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$description</span> <span class="o">=</span> <span class="s1">&#39;Publishes the latest daily photo to the homepage.&#39;</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$publisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Publisher</span><span class="p">(</span><span class="s1">&#39;/path/to/photos/&#39;</span><span class="p">,</span> <span class="nx">FCPATH</span> <span class="o">.</span> <span class="s1">&#39;assets/images&#39;</span><span class="p">);</span>

        <span class="k">try</span>
        <span class="p">{</span>
            <span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">addPath</span><span class="p">(</span><span class="s1">&#39;daily_photo.jpg&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">(</span><span class="k">true</span><span class="p">);</span> <span class="c1">// `true` to enable overwrites</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="nx">Throwable</span> <span class="nv">$e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">showError</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now running <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">publish:daily</span></code> will keep your homepage’s image up-to-date. What if the photo is
coming from an external API? You can use <code class="docutils literal notranslate"><span class="pre">addUri()</span></code> in place of <code class="docutils literal notranslate"><span class="pre">addPath()</span></code> to download the remote
resource and publish it out instead:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">addUri</span><span class="p">(</span><span class="s1">&#39;https://example.com/feeds/daily_photo.jpg&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="asset-dependencies-example">
<h3><a class="toc-backref" href="#id9">Asset Dependencies Example</a><a class="headerlink" href="#asset-dependencies-example" title="本標題的永久連結">¶</a></h3>
<p>You want to integrate the frontend library 「Bootstrap」 into your project, but the frequent updates makes it a hassle
to keep up with. You can create a publication definition in your project to sync frontend assets by extending
<code class="docutils literal notranslate"><span class="pre">Publisher</span></code> in your project. So <strong>app/Publishers/BootstrapPublisher.php</strong> might look like this:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Publishers</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\Publisher\Publisher</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">BootstrapPublisher</span> <span class="k">extends</span> <span class="nx">Publisher</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * Tell Publisher where to get the files.</span>
<span class="sd">     * Since we will use Composer to download</span>
<span class="sd">     * them we point to the &quot;vendor&quot; directory.</span>
<span class="sd">     *</span>
<span class="sd">     * @var string</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$source</span> <span class="o">=</span> <span class="s1">&#39;vendor/twbs/bootstrap/&#39;</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * FCPATH is always the default destination,</span>
<span class="sd">     * but we may want them to go in a sub-folder</span>
<span class="sd">     * to keep things organized.</span>
<span class="sd">     *</span>
<span class="sd">     * @var string</span>
<span class="sd">     */</span>
    <span class="k">protected</span> <span class="nv">$destination</span> <span class="o">=</span> <span class="nx">FCPATH</span> <span class="o">.</span> <span class="s1">&#39;bootstrap&#39;</span><span class="p">;</span>

    <span class="sd">/**</span>
<span class="sd">     * Use the &quot;publish&quot; method to indicate that this</span>
<span class="sd">     * class is ready to be discovered and automated.</span>
<span class="sd">     *</span>
<span class="sd">     * @return boolean</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">publish</span><span class="p">()</span><span class="o">:</span> <span class="nx">bool</span>
    <span class="p">{</span>
        <span class="k">return</span> <span class="nv">$this</span>
            <span class="c1">// Add all the files relative to $source</span>
            <span class="o">-&gt;</span><span class="na">addPath</span><span class="p">(</span><span class="s1">&#39;dist&#39;</span><span class="p">)</span>

            <span class="c1">// Indicate we only want the minimized versions</span>
            <span class="o">-&gt;</span><span class="na">retainPattern</span><span class="p">(</span><span class="s1">&#39;*.min.*&#39;</span><span class="p">)</span>

            <span class="c1">// Merge-and-replace to retain the original directory structure</span>
            <span class="o">-&gt;</span><span class="na">merge</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now add the dependency via Composer and call <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">publish</span></code> to run the publication:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;</span> <span class="nx">composer</span> <span class="k">require</span> <span class="nx">twbs</span><span class="o">/</span><span class="nx">bootstrap</span>
<span class="o">&gt;</span> <span class="nx">php</span> <span class="nx">spark</span> <span class="nx">publish</span>
</pre></div>
</div>
<p>… and you’ll end up with something like this:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">public</span><span class="o">/.</span><span class="nx">htaccess</span>
<span class="k">public</span><span class="o">/</span><span class="nx">favicon</span><span class="o">.</span><span class="nx">ico</span>
<span class="k">public</span><span class="o">/</span><span class="nx">index</span><span class="o">.</span><span class="nx">php</span>
<span class="k">public</span><span class="o">/</span><span class="nx">robots</span><span class="o">.</span><span class="nx">txt</span>
<span class="k">public</span><span class="o">/</span>
    <span class="nx">bootstrap</span><span class="o">/</span>
        <span class="nx">css</span><span class="o">/</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span>
            <span class="nx">bootstrap</span><span class="o">-</span><span class="nx">utilities</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span><span class="o">.</span><span class="nx">map</span>
            <span class="nx">bootstrap</span><span class="o">-</span><span class="nx">grid</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nx">rtl</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span><span class="o">.</span><span class="nx">map</span>
            <span class="nx">bootstrap</span><span class="o">-</span><span class="nx">reboot</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span>
            <span class="nx">bootstrap</span><span class="o">-</span><span class="nx">utilities</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span>
            <span class="nx">bootstrap</span><span class="o">-</span><span class="nx">reboot</span><span class="o">.</span><span class="nx">rtl</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span>
            <span class="nx">bootstrap</span><span class="o">-</span><span class="nx">grid</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">css</span><span class="o">.</span><span class="nx">map</span>
        <span class="nx">js</span><span class="o">/</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nx">esm</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">js</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nx">bundle</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">js</span><span class="o">.</span><span class="nx">map</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nx">bundle</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">js</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">js</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nx">esm</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">js</span><span class="o">.</span><span class="nx">map</span>
            <span class="nx">bootstrap</span><span class="o">.</span><span class="nb">min</span><span class="o">.</span><span class="nx">js</span><span class="o">.</span><span class="nx">map</span>
</pre></div>
</div>
</div>
<div class="section" id="module-deployment-example">
<h3><a class="toc-backref" href="#id10">Module Deployment Example</a><a class="headerlink" href="#module-deployment-example" title="本標題的永久連結">¶</a></h3>
<p>You want to allow developers using your popular authentication module the ability to expand on the default behavior
of your Migration, Controller, and Model. You can create your own module 「publish」 command to inject these components
into an application for use:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Math\Auth\Commands</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">CodeIgniter\CLI\BaseCommand</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">CodeIgniter\Publisher\Publisher</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Throwable</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">AuthPublish</span> <span class="k">extends</span> <span class="nx">BaseCommand</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="nv">$group</span>       <span class="o">=</span> <span class="s1">&#39;Auth&#39;</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$name</span>        <span class="o">=</span> <span class="s1">&#39;auth:publish&#39;</span><span class="p">;</span>
    <span class="k">protected</span> <span class="nv">$description</span> <span class="o">=</span> <span class="s1">&#39;Publish Auth components into the current application.&#39;</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">run</span><span class="p">(</span><span class="k">array</span> <span class="nv">$params</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// Use the Autoloader to figure out the module path</span>
        <span class="nv">$source</span> <span class="o">=</span> <span class="nx">service</span><span class="p">(</span><span class="s1">&#39;autoloader&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">getNamespace</span><span class="p">(</span><span class="s1">&#39;Math\\Auth&#39;</span><span class="p">);</span>

        <span class="nv">$publisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Publisher</span><span class="p">(</span><span class="nv">$source</span><span class="p">,</span> <span class="nx">APPATH</span><span class="p">);</span>

        <span class="k">try</span>
        <span class="p">{</span>
            <span class="c1">// Add only the desired components</span>
            <span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">addPaths</span><span class="p">([</span>
                <span class="s1">&#39;Controllers&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Database/Migrations&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Models&#39;</span><span class="p">,</span>
            <span class="p">])</span><span class="o">-&gt;</span><span class="na">merge</span><span class="p">(</span><span class="k">false</span><span class="p">);</span> <span class="c1">// Be careful not to overwrite anything</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="nx">Throwable</span> <span class="nv">$e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">showError</span><span class="p">(</span><span class="nv">$e</span><span class="p">);</span>
            <span class="k">return</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">// If publication succeeded then update namespaces</span>
        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">getPublished</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$file</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">// Replace the namespace</span>
            <span class="nv">$contents</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span>
            <span class="nv">$contents</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="s1">&#39;namespace Math\\Auth&#39;</span><span class="p">,</span> <span class="s1">&#39;namespace &#39;</span> <span class="o">.</span> <span class="nx">APP_NAMESPACE</span><span class="p">,</span> <span class="p">);</span>
            <span class="nb">file_put_contents</span><span class="p">(</span><span class="nv">$file</span><span class="p">,</span> <span class="nv">$contents</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now when your module users run <code class="docutils literal notranslate"><span class="pre">php</span> <span class="pre">spark</span> <span class="pre">auth:publish</span></code> they will have the following added to their project:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nx">app</span><span class="o">/</span><span class="nx">Controllers</span><span class="o">/</span><span class="nx">AuthController</span><span class="o">.</span><span class="nx">php</span>
<span class="nx">app</span><span class="o">/</span><span class="nx">Database</span><span class="o">/</span><span class="nx">Migrations</span><span class="o">/</span><span class="mi">2017</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="mi">223112</span><span class="nx">_create_auth_tables</span><span class="o">.</span><span class="nx">php</span><span class="o">.</span><span class="nx">php</span>
<span class="nx">app</span><span class="o">/</span><span class="nx">Models</span><span class="o">/</span><span class="nx">LoginModel</span><span class="o">.</span><span class="nx">php</span>
<span class="nx">app</span><span class="o">/</span><span class="nx">Models</span><span class="o">/</span><span class="nx">UserModel</span><span class="o">.</span><span class="nx">php</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="library-reference">
<span id="reference"></span><h2><a class="toc-backref" href="#id11">Library Reference</a><a class="headerlink" href="#library-reference" title="本標題的永久連結">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">備註</p>
<p class="last"><code class="docutils literal notranslate"><span class="pre">Publisher</span></code> is an extension of <a class="reference internal" href="files.html"><span class="doc">FileCollection</span></a> so has access to all those methods for reading and filtering files.</p>
</div>
<div class="section" id="support-methods">
<h3><a class="toc-backref" href="#id12">Support Methods</a><a class="headerlink" href="#support-methods" title="本標題的永久連結">¶</a></h3>
<p><strong>[static] discover(string $directory = 『Publishers』): Publisher[]</strong></p>
<p>Discovers and returns all Publishers in the specified namespace directory. For example, if both
<strong>app/Publishers/FrameworkPublisher.php</strong> and <strong>myModule/src/Publishers/AssetPublisher.php</strong> exist and are
extensions of <code class="docutils literal notranslate"><span class="pre">Publisher</span></code> then <code class="docutils literal notranslate"><span class="pre">Publisher::discover()</span></code> would return an instance of each.</p>
<p><strong>publish(): bool</strong></p>
<p>Processes the full input-process-output chain. By default this is the equivalent of calling <code class="docutils literal notranslate"><span class="pre">addPath($source)</span></code>
and <code class="docutils literal notranslate"><span class="pre">merge(true)</span></code> but child classes will typically provide their own implementation. <code class="docutils literal notranslate"><span class="pre">publish()</span></code> is called
on all discovered Publishers when running <code class="docutils literal notranslate"><span class="pre">spark</span> <span class="pre">publish</span></code>.
Returns success or failure.</p>
<p><strong>getScratch(): string</strong></p>
<p>Returns the temporary workspace, creating it if necessary. Some operations use intermediate storage to stage
files and changes, and this provides the path to a transient, writable directory that you may use as well.</p>
<p><strong>getErrors(): array&lt;string,Throwable&gt;</strong></p>
<p>Returns any errors from the last write operation. The array keys are the files that caused the error, and the
values are the Throwable that was caught. Use <code class="docutils literal notranslate"><span class="pre">getMessage()</span></code> on the Throwable to get the error message.</p>
<p><strong>addPath(string $path, bool $recursive = true)</strong>
<strong>addPaths(array $path, bool $recursive = true)</strong></p>
<p>Adds all files indicated by the relative paths. Paths are references to actual files or directories relative
to <code class="docutils literal notranslate"><span class="pre">$source</span></code>. If the relative path resolves to a directory then <code class="docutils literal notranslate"><span class="pre">$recursive</span></code> will include sub-directories.</p>
<p><strong>addUri(string $uri)</strong>
<strong>addUris(array $uris)</strong></p>
<p>Downloads the contents of a URI using <code class="docutils literal notranslate"><span class="pre">CURLRequest</span></code> into the scratch workspace then adds the resulting
file to the list.</p>
<div class="admonition note">
<p class="first admonition-title">備註</p>
<p class="last">The CURL request made is a simple <code class="docutils literal notranslate"><span class="pre">GET</span></code> and uses the response body for the file contents. Some
remote files may need a custom request to be handled properly.</p>
</div>
</div>
<div class="section" id="outputting-files">
<h3><a class="toc-backref" href="#id13">Outputting Files</a><a class="headerlink" href="#outputting-files" title="本標題的永久連結">¶</a></h3>
<p><strong>wipe()</strong></p>
<p>Removes all files, directories, and sub-directories from <code class="docutils literal notranslate"><span class="pre">$destination</span></code>.</p>
<div class="admonition important">
<p class="first admonition-title">重要</p>
<p class="last">Use wisely.</p>
</div>
<p><strong>copy(bool $replace = true): bool</strong></p>
<p>Copies all files into the <code class="docutils literal notranslate"><span class="pre">$destination</span></code>. This does not recreate the directory structure, so every file
from the current list will end up in the same destination directory. Using <code class="docutils literal notranslate"><span class="pre">$replace</span></code> will cause files
to overwrite when there is already an existing file. Returns success or failure, use <code class="docutils literal notranslate"><span class="pre">getPublished()</span></code>
and <code class="docutils literal notranslate"><span class="pre">getErrors()</span></code> to troubleshoot failures.
Be mindful of duplicate basename collisions, for example:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$publisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Publisher</span><span class="p">(</span><span class="s1">&#39;/home/source&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/destination&#39;</span><span class="p">);</span>
<span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">addPaths</span><span class="p">([</span>
    <span class="s1">&#39;pencil/lead.png&#39;</span><span class="p">,</span>
    <span class="s1">&#39;metal/lead.png&#39;</span><span class="p">,</span>
<span class="p">]);</span>

<span class="c1">// This is bad! Only one file will remain at /home/destination/lead.png</span>
<span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">copy</span><span class="p">(</span><span class="k">true</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>merge(bool $replace = true): bool</strong></p>
<p>Copies all files into the <code class="docutils literal notranslate"><span class="pre">$destination</span></code> in appropriate relative sub-directories. Any files that
match <code class="docutils literal notranslate"><span class="pre">$source</span></code> will be placed into their equivalent directories in <code class="docutils literal notranslate"><span class="pre">$destination</span></code>, effectively
creating a 「mirror」 or 「rsync」 operation. Using <code class="docutils literal notranslate"><span class="pre">$replace</span></code> will cause files
to overwrite when there is already an existing file; since directories are merged this will not
affect other files in the destination. Returns success or failure, use <code class="docutils literal notranslate"><span class="pre">getPublished()</span></code> and
<code class="docutils literal notranslate"><span class="pre">getErrors()</span></code> to troubleshoot failures.</p>
<p>Example:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="nv">$publisher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Publisher</span><span class="p">(</span><span class="s1">&#39;/home/source&#39;</span><span class="p">,</span> <span class="s1">&#39;/home/destination&#39;</span><span class="p">);</span>
<span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">addPaths</span><span class="p">([</span>
    <span class="s1">&#39;pencil/lead.png&#39;</span><span class="p">,</span>
    <span class="s1">&#39;metal/lead.png&#39;</span><span class="p">,</span>
<span class="p">]);</span>

<span class="c1">// Results in &quot;/home/destination/pencil/lead.png&quot; and &quot;/home/destination/metal/lead.png&quot;</span>
<span class="nv">$publisher</span><span class="o">-&gt;</span><span class="na">merge</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="security.html" class="btn btn-neutral float-right" title="安全性類別" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pagination.html" class="btn btn-neutral float-left" title="Pagination" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2021 CodeIgniter 基金會 | 國立高雄師範大學軟體工程與管理學系 SDPM 實驗室譯製 
      <span class="lastupdated">
        最後更新於 2021年12月03日。
      </span>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script>

  
  
    
   

</body>
</html>